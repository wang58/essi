# Generated by hyrax:models:install
class FileSet < ActiveFedora::Base
  include ESSI::FileSetMetadata
  include ::Hyrax::FileSetBehavior

  # FIXME: find a more appropriate file use?
  directly_contains_one :transcript, through: :files, type: ::RDF::URI('http://pcdm.org/use#Transcript'), class_name: 'Hydra::PCDM::File'

  self.indexer = ESSI::FileSetIndexer

  def collection_branding_info
    @collection_branding_info ||= CollectionBrandingInfo.where(file_set_id: self.id).first
  end

  def collection_branding?
    collection_branding_info.present?
  end

  def ocr_language
    [language.entries,
     parent&.language&.entries,
     ESSI.config.dig(:essi, :hocr_language),
     'eng'].map { |l| Tesseract.try_languages(l) }.select(&:present?).first
  end
end
